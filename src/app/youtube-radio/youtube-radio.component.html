<div class="h-full w-full bg-white dark:bg-gray-800 overflow-y-auto">
  <div class="p-4 bg-gray-800 dark:bg-gray-900 text-white sticky top-0">
    <h2 class="text-xl font-bold">YouTube 播放清單</h2>
  </div>

  <div class="p-4">
    <p-card [styleClass]="isDarkTheme ? 'dark-theme-card' : ''" class="w-full">
      <textarea 
        pInputTextarea 
        [rows]="5" 
        class="w-full dark:bg-gray-700 dark:text-white"
        [(ngModel)]="urlInput"
        placeholder="請輸入 YouTube 網址（每行一個）"
      ></textarea>
      <div class="mt-4 flex gap-2">
        <p-button label="載入播放清單" (click)="loadPlaylist()"></p-button>
        <p-button label="清除" (click)="clearPlaylist()" severity="secondary"></p-button>
      </div>
    </p-card>

    <div class="mt-4">
      <p-card *ngIf="currentVideoId" [styleClass]="isDarkTheme ? 'dark-theme-card' : ''" class="w-full">
        <div class="youtube-player-container">
          <youtube-player
            [videoId]="currentVideoId"
            [width]="'100%'"
            [playerVars]="playerConfig"
            (stateChange)="onPlayerStateChange($event)"
            #youtubePlayer
          ></youtube-player>
        </div>
        
        <div class="mt-4 flex gap-2">
          <p-button label="上一首" (click)="playPrevious()" [disabled]="currentIndex <= 0"></p-button>
          <p-button label="下一首" (click)="playNext()" [disabled]="currentIndex >= playlist.length - 1"></p-button>
        </div>
      </p-card>
    </div>

    <div class="mt-4">
      <p-card [styleClass]="isDarkTheme ? 'dark-theme-card' : ''" class="w-full">
        <h3 class="text-lg font-bold mb-2 dark:text-white">播放清單</h3>
        <div class="divide-y divide-gray-200 dark:divide-gray-700">
          @for (video of playlist; track video.id; let i = $index) {
            <div class="py-2 flex justify-between items-center dark:text-white"
                 [class.bg-blue-50]="i === currentIndex"
                 [class.dark:bg-blue-900]="i === currentIndex">
              <span>{{ video.title || video.id }}</span>
              <div class="flex gap-2">
                <p-button 
                  icon="pi pi-play" 
                  (click)="playIndex(i)"
                  [outlined]="true"
                  [disabled]="i === currentIndex"
                ></p-button>
                <p-button 
                  icon="pi pi-trash" 
                  (click)="removeFromPlaylist(i)"
                  [outlined]="true"
                  severity="danger"
                ></p-button>
              </div>
            </div>
          }
        </div>
      </p-card>
    </div>
  </div>
</div>